---
title: "3:46:37 PM - January 25, 2026"
date: 2026-01-25T23:46:37.152Z
timestamp: 1769384797152
---

## Project Notes

Critical logic bug found in the implementation:

Line 75: `id_above = max(taxon['id'] for taxon in results)`

This takes the max ONLY from the final page's results. However, in the algorithm:
- The break at line 70 triggers when batch_count >= (MAX_RESULTS_PER_SEARCH - per_page)
- This is 9800 when per_page=200
- The loop continues UNTIL we've yielded 9800 items
- The final page processed will have batch_count somewhere between 9800-9999
- So results (final page) might be partial or full

BUT the results variable is ONLY the final page's results, not all results in the batch.
If the IDs aren't sequential or are out of order, max(results) won't give the highest ID seen so far.

However, looking at test data - the API returns results in some order. If ordered by ID ascending, this would work. But there's no guarantee.

Actually wait - looking more carefully at the test mock setup:
- Line 62: `range(j*200+1, j*200+201)` for j in range(1,49)
- This creates ranges like: [201, 400], [401, 600], etc for j=1,2...
- So IDs ARE in ascending order in the mock
- But this doesn't mean the real API returns them in ID order!

This is a potential bug: assumes IDs are in ascending order within each page.

