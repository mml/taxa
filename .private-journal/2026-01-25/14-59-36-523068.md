---
title: "2:59:36 PM - January 25, 2026"
date: 2026-01-25T22:59:36.523Z
timestamp: 1769381976523
---

## Project Notes

**Task 3 Status - pyinaturalist Integration Issue:**

Found that Task 3 test and implementation already exist but are BROKEN:

1. **Test 1 Problem:** `test_fetch_taxon_descendants_calls_api`
   - Tests that `fetch_taxon_descendants()` calls the API
   - BUT: Implementation returns a Generator (Iterator)
   - Generators are lazy - `get_taxa` only called when iterated
   - Test calls `assert_called_once()` BEFORE iterating
   - Result: Test fails with "Called 0 times"

2. **Test 2:** `test_fetch_taxon_descendants_handles_pagination` - PASSES
   - Correctly iterates: `list(fetch_taxon_descendants(...))`
   - This properly consumes the generator
   - Test passes correctly

3. **Implementation:** Correct generator pattern
   - Properly implements pagination
   - Yields taxa as expected

**Solution:** Fix Test 1 to consume the generator before asserting on mock calls.
The test should either:
- Consume the generator: `list(fetch_taxon_descendants(...))` before checking mock
- OR: Check that mock WAS called during iteration

Per the implementation plan, Test 1 should verify the API call happens. Since it's a generator, need to actually start consuming results.

